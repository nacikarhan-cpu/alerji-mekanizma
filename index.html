<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alerji MekanizmasÄ± - Naci Karhan Testi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; background: #f0f4f8; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .correct-anim { animation: pulseGreen 0.5s ease-in-out; }
        .wrong-anim { animation: shake 0.5s ease-in-out; }
        @keyframes pulseGreen { 0% { background-color: white; } 50% { background-color: #d1fae5; } 100% { background-color: white; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .hidden { display: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

    <!-- Header -->
    <header class="w-full max-w-2xl text-center mb-6">
        <h1 class="text-3xl font-bold text-blue-800">Alerji MekanizmasÄ± ğŸ§¬</h1>
        <p class="text-blue-600 font-semibold">"Biyoloji ezber deÄŸil, mekanizmadÄ±r."</p>
    </header>

    <!-- App Container -->
    <main class="w-full max-w-2xl glass rounded-2xl shadow-xl overflow-hidden relative min-h-[500px] flex flex-col">
        
        <!-- GiriÅŸ BÃ¶lÃ¼mÃ¼ -->
        <section id="section-intro" class="p-8 flex flex-col items-center text-center space-y-6">
            <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center text-4xl">ğŸ¦ </div>
            <h2 class="text-2xl font-bold">HoÅŸ Geldin GenÃ§ ArkadaÅŸÄ±m!</h2>
            <p class="text-gray-600">BugÃ¼n vÃ¼cudumuzun "yanlÄ±ÅŸ alarm" senaryosu olan alerjiyi 25 soruda eleyeceÄŸiz. AYT derinliÄŸinde bir check-up'a hazÄ±r mÄ±sÄ±n?</p>
            <div class="w-full space-y-2 text-left bg-gray-50 p-4 rounded-lg text-sm">
                <p>âœ… <b>MÃ¼fredat:</b> 2024 MEB GÃ¼ncel</p>
                <p>âœ… <b>Soru & ÅÄ±klar:</b> 25 Soru, Her Denemede KarÄ±ÅŸÄ±k</p>
                <p>âœ… <b>Seviye:</b> AYT / 11. SÄ±nÄ±f</p>
            </div>
            <button onclick="showSection('discover')" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-all shadow-lg transform hover:scale-105">
                KEÅFET & BAÅLA
            </button>
        </section>

        <!-- KeÅŸfet BÃ¶lÃ¼mÃ¼ -->
        <section id="section-discover" class="hidden p-8 space-y-6">
            <h2 class="text-2xl font-bold text-blue-800 border-b pb-2">HÄ±zlÄ± HatÄ±rlatma ğŸ”¬</h2>
            <div class="space-y-4 text-gray-700 leading-relaxed overflow-y-auto max-h-[400px] pr-2 text-sm">
                <p><b>1. DuyarlÄ±laÅŸma:</b> Alerjen ilk kez girer, B lenfositler <b>IgE</b> Ã¼retir, bu antikorlar <b>Mast hÃ¼crelerine</b> yapÄ±ÅŸÄ±r.</p>
                <p><b>2. Reaksiyon:</b> AynÄ± alerjen tekrar girdiÄŸinde Mast Ã¼zerindeki IgE'ye baÄŸlanÄ±r. Mast hÃ¼cresi patlar ve <b>HÄ°STAMÄ°N</b> salgÄ±lanÄ±r.</p>
                <p><b>3. SonuÃ§:</b> Histamin damarlarÄ± geniÅŸletir, geÃ§irgenliÄŸi artÄ±rÄ±r, doku sÄ±vÄ±sÄ± artar (Ã–DEM), tansiyon dÃ¼ÅŸer.</p>
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3 italic text-xs">
                    Unutma! Alerjide doku sÄ±vÄ±sÄ± azalmaz, ARTAR.
                </div>
            </div>
            <div class="flex flex-col gap-2">
                <button onclick="startQuiz()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-xl transition-all shadow-lg transform hover:scale-105">
                    TESTÄ° BAÅLAT
                </button>
                <button onclick="showSection('intro')" class="w-full text-gray-500 font-semibold py-2 text-sm">Geri DÃ¶n</button>
            </div>
        </section>

        <!-- Quiz BÃ¶lÃ¼mÃ¼ -->
        <section id="section-quiz" class="hidden flex-1 flex flex-col">
            <!-- Stats Bar -->
            <div class="bg-blue-50 p-3 flex justify-between items-center border-b">
                <button onclick="confirmExit()" class="text-xs bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded-lg font-bold transition-all">ğŸ  MenÃ¼ye DÃ¶n</button>
                <div class="font-mono font-bold text-blue-700 text-sm" id="timer">00:00</div>
                <div class="font-semibold text-gray-600 text-sm" id="progress-text">1/25</div>
            </div>
            <!-- Question Content -->
            <div class="p-6 flex-1 overflow-y-auto">
                <div id="question-text" class="text-lg font-semibold text-gray-800 mb-6">Soru metni...</div>
                <div id="options-container" class="space-y-3">
                    <!-- Butonlar JS ile gelecek -->
                </div>
            </div>
            <!-- Feedback Overlay -->
            <div id="feedback" class="hidden absolute inset-0 bg-white bg-opacity-95 flex flex-col items-center justify-center p-8 text-center z-20">
                <div id="feedback-icon" class="text-6xl mb-4"></div>
                <div id="feedback-title" class="text-2xl font-bold mb-2"></div>
                <div id="feedback-desc" class="text-gray-600 mb-6 text-sm"></div>
                <button onclick="nextQuestion()" class="bg-blue-600 text-white px-8 py-2 rounded-full font-bold shadow-md hover:bg-blue-700 transition-all">SIRADAKÄ° SORU</button>
            </div>
        </section>

        <!-- SonuÃ§ BÃ¶lÃ¼mÃ¼ -->
        <section id="section-result" class="hidden p-8 flex flex-col items-center text-center">
            <h2 class="text-3xl font-bold text-blue-800 mb-4 text-shadow">SÄ±nav Karnesi ğŸ“Š</h2>
            <div id="badge-container" class="w-full py-6 mb-6 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-inner">
                <div id="result-emoji" class="text-6xl mb-2">ğŸ†</div>
                <h3 id="result-title" class="text-xl font-bold">BAÄIÅIKLIK MUHAFIZI</h3>
                <p class="text-sm opacity-80">AYT Biyoloji - Alerji MekanizmasÄ±</p>
            </div>
            
            <div class="grid grid-cols-2 gap-4 w-full mb-8">
                <div class="bg-green-50 p-4 rounded-xl border border-green-200">
                    <span class="block text-gray-500 text-xs uppercase">DoÄŸru</span>
                    <span id="res-correct" class="text-2xl font-bold text-green-600">0</span>
                </div>
                <div class="bg-red-50 p-4 rounded-xl border border-red-200">
                    <span class="block text-gray-500 text-xs uppercase">YanlÄ±ÅŸ</span>
                    <span id="res-wrong" class="text-2xl font-bold text-red-600">0</span>
                </div>
                <div class="bg-blue-50 p-4 rounded-xl border border-blue-200 col-span-2">
                    <span class="block text-gray-500 text-xs uppercase">BaÅŸarÄ± YÃ¼zdesi</span>
                    <span id="res-percent" class="text-2xl font-bold text-blue-600">%0</span>
                </div>
            </div>

            <div class="flex flex-col w-full gap-3">
                <button onclick="startQuiz()" class="bg-blue-600 text-white font-bold py-3 rounded-xl shadow-lg">TEKRAR DENE</button>
                <button onclick="showSection('intro')" class="text-blue-600 font-semibold py-2">ANA MENÃœYE DÃ–N</button>
                <p class="text-[10px] text-gray-400 mt-4 italic">Ekran gÃ¶rÃ¼ntÃ¼sÃ¼ alÄ±p #NaciKarhan etiketiyle paylaÅŸabilirsin!</p>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-auto bg-gray-100 p-2 text-center text-xs text-gray-500 border-t font-semibold">
            TasarÄ±m: Naci Karhan
        </footer>
    </main>

    <script>
        const originalQuestions = [
            { q: "VÃ¼cuda giren aslÄ±nda zararsÄ±z olan maddelere karÅŸÄ± verilen aÅŸÄ±rÄ± yangÄ±sal tepkiye ne denir?", a: ["Enfeksiyon", "Alerji", "OtoimmÃ¼nite", "Fagositoz", "Kemotaksis"], c: 1, e: "Alerji, zararsÄ±z bir maddeyi (alerjen) dÃ¼ÅŸman sanma durumudur." },
            { q: "Alerjik reaksiyonlarÄ±n temelini oluÅŸturan ve Mast hÃ¼crelerine baÄŸlanan antikor sÄ±nÄ±fÄ± hangisidir?", a: ["IgG", "IgA", "IgM", "IgE", "IgD"], c: 3, e: "IgE sÄ±nÄ±fÄ± antikorlar alerji mekanizmasÄ±nÄ±n ana mÃ¼himmatÄ±dÄ±r." },
            { q: "Histamin salgÄ±layarak alerjik belirtileri baÅŸlatan baÄŸ doku hÃ¼cresi hangisidir?", a: ["Makrofaj", "Fibroblast", "Mast HÃ¼cresi", "Plazma HÃ¼cresi", "Melanosit"], c: 2, e: "Mast hÃ¼creleri iÃ§indeki histamin granÃ¼llerini boÅŸaltarak tepkiyi baÅŸlatÄ±r." },
            { q: "DuyarlÄ±laÅŸma (1. KarÅŸÄ±laÅŸma) aÅŸamasÄ±nda hangisi gerÃ§ekleÅŸmez?", a: ["Alerjen giriÅŸi", "B lenfosit uyarÄ±lmasÄ±", "IgE Ã¼retimi", "Histamin patlamasÄ±", "IgE'nin Mast hÃ¼cresine baÄŸlanmasÄ±"], c: 3, e: "Histamin patlamasÄ± asÄ±l belirtilerin gÃ¶rÃ¼ldÃ¼ÄŸÃ¼ 2. karÅŸÄ±laÅŸmada olur." },
            { q: "Histamin salgÄ±sÄ± sonucu kÄ±lcal damarlarda gÃ¶rÃ¼len deÄŸiÅŸim hangisidir?", a: ["GeÃ§irgenlik artar", "BÃ¼zÃ¼lme olur", "GeÃ§irgenlik azalÄ±r", "Kan akÄ±ÅŸÄ± durur", "HÃ¼cre sayÄ±sÄ± azalÄ±r"], c: 0, e: "Histamin damar geÃ§irgenliÄŸini artÄ±rarak dokuya sÄ±vÄ± geÃ§iÅŸini saÄŸlar." },
            { q: "Alerjik reaksiyon sÄ±rasÄ±nda doku sÄ±vÄ±sÄ± miktarÄ±nÄ±n artmasÄ±na ne ad verilir?", a: ["Anemi", "Ã–dem", "Diyaliz", "Plazmoliz", "Hemoliz"], c: 1, e: "Kandan dokuya sÄ±zan sÄ±vÄ± doku ÅŸiÅŸmesine (Ã¶dem) yol aÃ§ar." },
            { q: "Alerji ile otoimmÃ¼n hastalÄ±k arasÄ±ndaki temel fark nedir?", a: ["Alerji kalÄ±tsaldÄ±r", "OtoimmÃ¼nite dÄ±ÅŸ etkendir", "Hedef: DÄ±ÅŸ zararsÄ±z madde (Alerji) vs Kendi HÃ¼cresi (OtoimmÃ¼nite)", "Alerji daha tehlikelidir", "Ä°kisi aynÄ± ÅŸeydir"], c: 2, e: "Alerjide 'dostu dÃ¼ÅŸman sanmak', otoimmÃ¼nitede 'kendine saldÄ±rmak' vardÄ±r." },
            { q: "AÅŸaÄŸÄ±dakilerden hangisi bir otoimmÃ¼n hastalÄ±k Ã¶rneÄŸidir?", a: ["Saman Nezlesi", "ArÄ± SokmasÄ±", "FÄ±stÄ±k Alerjisi", "Ã‡Ã¶lyak", "AstÄ±m"], c: 3, e: "Ã‡Ã¶lyak, MS ve Romatoid Artrit baÄŸÄ±ÅŸÄ±klÄ±k sisteminin kendi dokusuna saldÄ±rdÄ±ÄŸÄ± hastalÄ±klardÄ±r." },
            { q: "Histamin damarlarÄ± geniÅŸlettiÄŸi (vazodilatasyon) iÃ§in kan basÄ±ncÄ±nda ne beklenir?", a: ["Aniden yÃ¼kselir", "DeÄŸiÅŸmez", "Aniden dÃ¼ÅŸebilir", "Ã–nce artar sonra azalÄ±r", "NabÄ±z durur"], c: 2, e: "DamarlarÄ±n geniÅŸlemesi toplam damar hacmini artÄ±rÄ±r ve tansiyonu dÃ¼ÅŸÃ¼rÃ¼r." },
            { q: "Solunum yollarÄ±ndaki dÃ¼z kaslarÄ±n histamin etkisiyle kasÄ±lmasÄ± neye yol aÃ§ar?", a: ["Derin nefes alma", "Nefes darlÄ±ÄŸÄ±", "Ses tellerinin geliÅŸimi", "Yutkunma zorluÄŸu", "AteÅŸ yÃ¼kselmesi"], c: 1, e: "Hava yollarÄ±nÄ±n daralmasÄ± astÄ±m benzeri nefes darlÄ±ÄŸÄ± oluÅŸturur." },
            { q: "Alerji belirtilerini durdurmak iÃ§in kullanÄ±lan ilaÃ§larÄ±n genel adÄ± nedir?", a: ["Antibiyotik", "Antihistaminik", "Antijen", "Analjezik", "Antipiretik"], c: 1, e: "Antihistaminikler hÃ¼crelerdeki histamin reseptÃ¶rlerini bloke ederek sinyal iletimini durdurur." },
            { q: "Alerjen vÃ¼cuda girdiÄŸinde durumu yanlÄ±ÅŸ yorumlayÄ±p B lenfositleri uyaran 'GÃ¶zcÃ¼' hÃ¼cre hangisidir?", a: ["B Lenfosit", "T Lenfosit", "Eritrosit", "Trombosit", "Osteosit"], c: 1, e: "YardÄ±mcÄ± T hÃ¼creleri antijeni tanÄ±yÄ±p B hÃ¼crelerini antikor Ã¼retimine zorlar." },
            { q: "AÅŸaÄŸÄ±dakilerden hangisi bir 'alerjen' olabilir?", a: ["Patojen VirÃ¼s", "Polen", "Zehirli Bakteri", "Kendi HÃ¼cremiz", "Glikoz"], c: 1, e: "Alerjenler (polen, fÄ±stÄ±k vb.) aslÄ±nda patojen olmayan ama tepki doÄŸuran maddelerdir." },
            { q: "SalgÄ± bezlerinin histaminle uyarÄ±lmasÄ± sonucu hangi durum gÃ¶rÃ¼lÃ¼r?", a: ["Deride kuruma", "Mukus artÄ±ÅŸÄ±", "GÃ¶z yaÅŸÄ± azalmasÄ±", "TÃ¼kÃ¼rÃ¼k kesilmesi", "SaÃ§ dÃ¶kÃ¼lmesi"], c: 1, e: "Burun akÄ±ntÄ±sÄ± ve balgam gibi mukus artÄ±ÅŸlarÄ± bu mekanizmayla olur." },
            { q: "Ä°kinci karÅŸÄ±laÅŸmada (Tetik Ã‡ekilmesi) alerjen nereye baÄŸlanÄ±r?", a: ["HÃ¼cre Ã§ekirdeÄŸine", "Serbest antikorlara", "Mast hÃ¼cresi Ã¼zerindeki hazÄ±r IgE'ye", "Alveollere", "Kemik iliÄŸine"], c: 2, e: "Mekanizma hazÄ±r bekleyen (kurulmuÅŸ bomba) Mast hÃ¼cresinde tetiklenir." },
            { q: "Alerjik reaksiyonun geliÅŸme sÄ±rasÄ± hangisinde doÄŸrudur?", a: ["Tetiklenme > DuyarlÄ±laÅŸma > Histamin", "DuyarlÄ±laÅŸma > Tetiklenme > Histamin", "Histamin > DuyarlÄ±laÅŸma > Tetiklenme", "Tetiklenme > Histamin > DuyarlÄ±laÅŸma", "Histamin > Tetiklenme > DuyarlÄ±laÅŸma"], c: 1, e: "Ã–nce hazÄ±rlÄ±k (DuyarlÄ±laÅŸma), sonra temas (Tetiklenme), sonra sonuÃ§ (Histamin)." },
            { q: "AÅŸaÄŸÄ±dakilerden hangisi alerjinin kazanÄ±lmÄ±ÅŸ baÄŸÄ±ÅŸÄ±klÄ±k bozukluÄŸu olduÄŸunu kanÄ±tlar?", a: ["DoÄŸuÅŸtan olmasÄ±", "Fagositoz yapÄ±lmasÄ±", "Ã–zgÃ¼l IgE antikorlarÄ±nÄ±n Ã¼retilmesi", "AteÅŸin Ã§Ä±kmasÄ±", "Derinin fiziksel engel olmasÄ±"], c: 2, e: "Spesifik antikor Ã¼retimi (IgE) kazanÄ±lmÄ±ÅŸ (Ã¶zgÃ¼l) baÄŸÄ±ÅŸÄ±klÄ±kla ilgilidir." },
            { q: "KÄ±lcal damar geÃ§irgenliÄŸi arttÄ±ÄŸÄ±nda doku sÄ±vÄ±sÄ±na geÃ§iÅŸi hÄ±zlanan yapÄ± hangisidir?", a: ["Alyuvarlar", "Kan PlazmasÄ± (SÄ±vÄ± kÄ±sÄ±m)", "Sinir HÃ¼creleri", "Kemik HÃ¼creleri", "Oksijen molekÃ¼lleri"], c: 1, e: "Damardan sÄ±zan plazma doku aralÄ±ÄŸÄ±nda birikerek Ã¶demi oluÅŸturur." },
            { q: "Alerjik ÅŸok (Anafilaksi) durumunda acil mÃ¼dahalenin temel sebebi nedir?", a: ["KaÅŸÄ±ntÄ±yÄ± durdurmak", "Kan basÄ±ncÄ±nÄ±n aÅŸÄ±rÄ± dÃ¼ÅŸmesini engellemek", "AteÅŸi dÃ¼ÅŸÃ¼rmek", "YarayÄ± temizlemek", "AÄŸrÄ±yÄ± kesmek"], c: 1, e: "Aniden dÃ¼ÅŸen tansiyon hayati risk (ÅŸok) oluÅŸturur." },
            { q: "B lenfositler uyarÄ±ldÄ±ÄŸÄ±nda antikor Ã¼retmek iÃ§in hangi hÃ¼creye dÃ¶nÃ¼ÅŸÃ¼r?", a: ["HafÄ±za hÃ¼cresi", "Plazma hÃ¼cresi", "KÃ¶k hÃ¼cre", "Destek hÃ¼cresi", "Sinir hÃ¼cresi"], c: 1, e: "Plazma hÃ¼creleri vÃ¼cudun 'antikor fabrikalarÄ±'dÄ±r." },
            { q: "Mast hÃ¼creleri baÄŸ dokunun dÄ±ÅŸÄ±nda hangi koruma sisteminde de yer alÄ±r?", a: ["Fiziksel engeller", "Ä°Ã§ savunma hattÄ± (YangÄ±sal tepki)", "DoÄŸal baÄŸÄ±ÅŸÄ±klÄ±k", "Aktif taÅŸÄ±ma", "Pasif baÄŸÄ±ÅŸÄ±klÄ±k"], c: 1, e: "Mast hÃ¼creleri ve histamin yangÄ±sal tepkinin (Ä°ltihaplanma) de ana aktÃ¶rÃ¼dÃ¼r." },
            { q: "Alerjik reaksiyonlarda gÃ¶rÃ¼len 'kÄ±zarÄ±klÄ±k' ve 'sÄ±caklÄ±k artÄ±ÅŸÄ±nÄ±n' sebebi nedir?", a: ["HÃ¼cre Ã¶lÃ¼mÃ¼", "DamarlarÄ±n geniÅŸleyip bÃ¶lgeye kan akÄ±ÅŸÄ±nÄ±n artmasÄ±", "Su kaybÄ±", "Mikrop Ã¼remesi", "Vitamin eksikliÄŸi"], c: 1, e: "GeniÅŸleyen damarlardan geÃ§en fazla kan bÃ¶lgeyi kÄ±zartÄ±r ve Ä±sÄ±tÄ±r." },
            { q: "Neden ilk karÅŸÄ±laÅŸmada alerji belirtisi gÃ¶rÃ¼lmez?", a: ["Alerjen zayÄ±ftÄ±r", "VÃ¼cut yorgundur", "Antikorlar henÃ¼z Mast hÃ¼crelerine yerleÅŸme aÅŸamasÄ±ndadÄ±r", "Alerjen hemen Ã¶lÃ¼r", "T lenfositler uyumaktadÄ±r"], c: 2, e: "Ä°lk karÅŸÄ±laÅŸma 'duyarlÄ±laÅŸma' yani hazÄ±rlÄ±k evresidir, patlama 2. karÅŸÄ±laÅŸmada olur." },
            { q: "Alerjik astÄ±m durumunda hangi sistem doÄŸrudan etkilenir?", a: ["Sindirim", "BoÅŸaltÄ±m", "Solunum", "Ãœreme", "Ä°skelet"], c: 2, e: "BronÅŸlardaki daralma solunum sistemini kilitler." },
            { q: "Biyolojide alerji mekanizmasÄ± iÃ§in en doÄŸru ifade hangisidir?", a: ["VÃ¼cudun dÄ±ÅŸarÄ±ya kapÄ±larÄ±nÄ± kapatmasÄ±", "BaÄŸÄ±ÅŸÄ±klÄ±k sisteminin 'YanlÄ±ÅŸ Alarm' vermesi", "HÃ¼crelerin kendi kendini sindirmesi", "Genetik mutasyonun sonucu", "Bakteri saldÄ±rÄ±sÄ±"], c: 1, e: "Alerji, zararsÄ±z bir ÅŸeye karÅŸÄ± gereksiz yere savaÅŸ aÃ§Ä±lmasÄ±dÄ±r." }
        ];

        let questions = [];
        let currentIdx = 0;
        let correctCount = 0;
        let wrongCount = 0;
        let timerSeconds = 0;
        let timerInterval;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function showSection(id) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById('section-' + id).classList.remove('hidden');
            if(id === 'intro' || id === 'discover') {
                clearInterval(timerInterval);
                timerSeconds = 0;
            }
        }

        function confirmExit() {
            if(confirm("SÄ±navdan Ã§Ä±kmak ve ana menÃ¼ye dÃ¶nmek istediÄŸine emin misin? Ä°lerlemen kaybolacak.")) {
                showSection('intro');
            }
        }

        function startQuiz() {
            // SorularÄ± kopyala, seÃ§enekleri karÄ±ÅŸtÄ±r ve sonra soru sÄ±rasÄ±nÄ± karÄ±ÅŸtÄ±r
            questions = originalQuestions.map(q => {
                let optionsWithIndex = q.a.map((text, idx) => ({ text, isCorrect: idx === q.c }));
                shuffle(optionsWithIndex);
                return {
                    q: q.q,
                    a: optionsWithIndex.map(o => o.text),
                    c: optionsWithIndex.findIndex(o => o.isCorrect),
                    e: q.e
                };
            });
            shuffle(questions);
            
            currentIdx = 0;
            correctCount = 0;
            wrongCount = 0;
            timerSeconds = 0;
            
            showSection('quiz');
            startTimer();
            loadQuestion();
        }

        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timerSeconds++;
                const mins = String(Math.floor(timerSeconds / 60)).padStart(2, '0');
                const secs = String(timerSeconds % 60).padStart(2, '0');
                document.getElementById('timer').innerText = `${mins}:${secs}`;
            }, 1000);
        }

        function loadQuestion() {
            const q = questions[currentIdx];
            document.getElementById('progress-text').innerText = `${currentIdx + 1}/${questions.length}`;
            document.getElementById('question-text').innerText = q.q;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            q.a.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-xl border-2 border-gray-100 hover:border-blue-400 hover:bg-blue-50 transition-all font-medium flex items-center text-sm sm:text-base";
                btn.innerHTML = `<span class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-blue-100 text-blue-800 flex items-center justify-center mr-3 shrink-0 font-bold">${String.fromCharCode(65+i)}</span> ${opt}`;
                btn.onclick = () => checkAnswer(i);
                container.appendChild(btn);
            });
            document.getElementById('feedback').classList.add('hidden');
        }

        function checkAnswer(selectedIdx) {
            const q = questions[currentIdx];
            const isCorrect = selectedIdx === q.c;
            
            if(isCorrect) {
                correctCount++;
                showFeedback("ğŸ”” TEBRÄ°KLER!", "DoÄŸru Cevap!", q.e, "âœ…");
            } else {
                wrongCount++;
                showFeedback("âŒ DÄ°KKAT!", `YanlÄ±ÅŸ Cevap! (DoÄŸru: ${String.fromCharCode(65+q.c)})`, q.e, "âš ï¸");
            }
        }

        function showFeedback(title, desc, explanation, icon) {
            document.getElementById('feedback-title').innerText = title;
            document.getElementById('feedback-desc').innerHTML = `<b>${desc}</b><br><br>${explanation}`;
            document.getElementById('feedback-icon').innerText = icon;
            document.getElementById('feedback').classList.remove('hidden');
        }

        function nextQuestion() {
            currentIdx++;
            if(currentIdx < questions.length) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            clearInterval(timerInterval);
            showSection('result');
            const percent = Math.round((correctCount / questions.length) * 100);
            document.getElementById('res-correct').innerText = correctCount;
            document.getElementById('res-wrong').innerText = wrongCount;
            document.getElementById('res-percent').innerText = `%${percent}`;
            
            let badge = "BAÄIÅIKLIK MUHAFIZI";
            let emoji = "ğŸ†";
            if(percent < 50) { badge = "Ã‡ALIÅKAN Ã–ÄRENCÄ°"; emoji = "ğŸ“š"; }
            else if(percent < 85) { badge = "MOLEKÃœLER ANALÄ°ST"; emoji = "ğŸ”¬"; }
            
            document.getElementById('result-title').innerText = badge;
            document.getElementById('result-emoji').innerText = emoji;
        }
    </script>
</body>
</html>